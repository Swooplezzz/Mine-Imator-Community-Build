/*
	NOTE:
	This file was autogenerated by CppGen, changes may be overwritten and forever lost!
	Modify at your own risk!
	
	[ Generated on 2023.07.27 19:31:02 ]
*/

#include "Scripts.hpp"

namespace CppProject
{
	RealType draw_label(ScopeAny self, VarArgs argument)
	{
		IntType argument_count = argument.Size();
		VarType str, xx, yy, halign, valign, color, alpha, font, seperation, width;
		IntType oldcolor;
		RealType oldalpha;
		RealType strwid, strhei;
		VarType strx, stry;
		str = argument[IntType(0)];
		xx = argument[IntType(1)];
		yy = argument[IntType(2)];
		strx = xx;
		stry = yy;
		seperation = -IntType(1);
		width = -IntType(1);
		if (argument_count <= IntType(7))
		{
			strwid = string_width(str);
			strhei = string_height(str);
			if (xx + strwid < sVar(content_x) || xx > sVar(content_x) + sVar(content_width) || yy + strhei < sVar(content_y) || yy > sVar(content_y) + sVar(content_height))
				return IntType(0);
		}
		if (argument_count > IntType(3))
		{
			halign = argument[IntType(3)];
			valign = argument[IntType(4)];
			draw_set_halign((IntType)(halign));
			draw_set_valign((IntType)(valign));
			if (argument_count <= IntType(7))
			{
				if (halign == fa_right)
					strx = xx - strwid;
				else
					if (halign == fa_center)
						strx = xx - strwid / 2.0;
				
				if (valign == fa_middle)
					stry = yy - strhei / 2.0;
				else
					if (valign == fa_bottom)
						stry = yy - strhei;
				
				if (strx + strwid < IntType(0) || strx > sVar(content_x) + sVar(content_width) || stry + strhei < IntType(0) || stry > sVar(content_y) + sVar(content_height))
				{
					draw_set_halign(fa_left);
					draw_set_valign(fa_top);
					return IntType(0);
				}
			}
			if (argument_count > IntType(5))
			{
				color = argument[IntType(5)];
				alpha = argument[IntType(6)];
				if (color != null_)
				{
					oldcolor = draw_get_color();
					draw_set_color((IntType)(color));
				}
				if (alpha < IntType(1))
				{
					oldalpha = draw_get_alpha();
					draw_set_alpha(oldalpha * alpha);
				}
				if (argument_count > IntType(7))
				{
					font = argument[IntType(7)];
					draw_set_font((IntType)(font));
					strwid = string_width(str);
					strhei = string_height(str);
					if (halign == fa_right)
						strx = xx - strwid;
					else
						if (halign == fa_center)
							strx = xx - strwid / 2.0;
					
					if (valign == fa_middle)
						stry = yy - strhei / 2.0;
					else
						if (valign == fa_bottom)
							stry = yy - strhei;
					
					if (strx + strwid < IntType(0) || strx > sVar(content_x) + sVar(content_width) || stry + strhei < IntType(0) || stry > sVar(content_y) + sVar(content_height))
					{
						draw_set_halign(fa_left);
						draw_set_valign(fa_top);
						if (color != null_)
							draw_set_color(oldcolor);
						if (alpha < IntType(1))
							draw_set_alpha(oldalpha);
						return IntType(0);
					}
					if (argument_count > IntType(8))
					{
						seperation = argument[IntType(8)];
						width = argument[IntType(9)];
					}
				}
			}
		}
		if (seperation == -IntType(1) && width == -IntType(1))
			draw_text((IntType)(xx), (IntType)(yy), str);
		else
			draw_text_ext((IntType)(xx), (IntType)(yy), str, (IntType)(seperation), (IntType)(width));
		
		if (argument_count > IntType(3))
		{
			draw_set_halign(fa_left);
			draw_set_valign(fa_top);
			if (argument_count > IntType(5))
			{
				if (color != null_)
					draw_set_color(oldcolor);
				if (alpha < IntType(1))
					draw_set_alpha(oldalpha);
			}
		}
		return 0.0;
	}
	
	void draw_label_value(ScopeAny self, VarType xx, VarType yy, VarType w, RealType h, VarType caption, VarType value, BoolType vertical)
	{
		IntType capwid;
		VarType valuex;
		if (!vertical)
			caption = caption + /*": "*/ STR(1037);
		draw_set_font(sInt(font_label));
		caption = string_limit(caption, w);
		capwid = string_width(caption);
		valuex = xx + capwid;
		if (vertical)
			draw_label(self, { caption, xx, yy + IntType(18), fa_left, fa_bottom, global::c_text_secondary, global::a_text_secondary });
		else
			draw_label(self, { caption, xx, yy + h / 2.0, fa_left, fa_middle, global::c_text_secondary, global::a_text_secondary });
		
		draw_set_font(sInt(font_value));
		if (vertical)
		{
			value = string_limit(value, w);
			draw_label(self, { value, xx, yy + IntType(36), fa_left, fa_bottom, global::c_text_main, global::a_text_main });
		}
		else
		{
			value = string_limit(value, (xx + w) - valuex);
			draw_label(self, { value, xx + capwid, yy + h / 2.0, fa_left, fa_middle, global::c_text_main, global::a_text_main });
		}
		
	}
	
	void draw_line_ext(VarType x1, VarType y1, VarType x2, VarType y2, VarType color, RealType alpha)
	{
		alpha = alpha * draw_get_alpha();
		draw_primitive_begin(pr_linelist);
		draw_vertex_color((IntType)(x1), (IntType)(y1), (IntType)(color), alpha);
		draw_vertex_color((IntType)(x2), (IntType)(y2), (IntType)(color), alpha);
		draw_primitive_end();
	}
	
	void draw_loading_bar(ScopeAny self, VarType xx, VarType yy, VarType wid, RealType hei, RealType perc, VarType text, VarType hinttext)
	{
		yy += IntType(8);
		draw_label(self, { text, xx, yy, fa_left, fa_center, global::c_text_main, global::a_text_main, sInt(font_value) });
		draw_label(self, { hinttext, xx + wid, yy, fa_right, fa_center, global::c_text_secondary, global::a_text_secondary, sInt(font_value) });
		yy += IntType(16);
		draw_box(xx, yy, wid, hei, false, global::c_border, global::a_border);
		draw_box(xx, yy, wid * perc, hei, false, global::c_accent, IntType(1));
	}
	
	RealType draw_meter(ScopeAny self, StringType name, VarType xx, VarType yy, VarType wid, VarType value, RealType minval, RealType maxval, RealType def, RealType snapval, VarType tbx, IntType script, StringType tip)
	{
		RealType hei, thumbhei, trackwid;
		VarType linex, linewid, trackx, dragval, dragx, dragy, inputfocus;
		BoolType mouseon, slidermouseon, locked;
		thumbhei = IntType(20);
		hei = (thumbhei + IntType(24));
		locked = (minval == maxval);
		if (xx + wid < sVar(content_x) || xx > sVar(content_x) + sVar(content_width) || yy + hei < sVar(content_y) || yy > sVar(content_y) + sVar(content_height))
		{
			if (sBool(textbox_jump))
				ds_list_add({ sInt(textbox_list), ArrType::From({ tbx, sVar(content_tab), yy, sVar(content_y), sVar(content_height) }) });
			return IntType(0);
		}
		mouseon = app_mouse_box(self, xx, yy, wid, hei) && sBool(content_mouseon);
		slidermouseon = app_mouse_box(self, xx, yy + IntType(24), wid, thumbhei) && sBool(content_mouseon);
		microani_set(name, script, false, false, false);
		RealType compact = (global::_app->panel_compact > 0 || sReal(window_compact) > 0);
		RealType draggerwid = ((compact > 0) ? dragger_width : IntType(80));
		draw_dragger(self, name + /*"input"*/ STR(1081), (xx + wid - draggerwid) + ((IntType)!(compact > 0) * IntType(6)), yy, draggerwid, value, snapval * .1, minval, maxval, def, snapval, tbx, script, null_, false);
		inputfocus = global::microani_arr.Value(e_microani_ACTIVE);
		if (sVar(window_busy) == name || (sVar(window_busy) != name + /*"inputpress"*/ STR(1082) && sVar(window_focus) != string(tbx)))
			ObjType(obj_textbox, tbx)->text = string_decimals(value);
		microani_set(name, script, (sVar(window_busy) == name) || slidermouseon, slidermouseon && sBool(mouse_left), false, false, IntType(1), false);
		microani_update({ slidermouseon, slidermouseon && sBool(mouse_left), sVar(window_busy) == name, locked, mouseon || (sVar(window_busy) == name + /*"inputpress"*/ STR(1082) || sVar(window_focus) == string(tbx)) });
		IntType labelcolor;
		RealType labelalpha;
		labelcolor = merge_color((IntType)(global::c_text_secondary), (IntType)(global::c_text_main), global::microani_arr.Value(e_microani_HOVER));
		labelcolor = merge_color(labelcolor, (IntType)(global::c_accent), max({ inputfocus, global::microani_arr.Value(e_microani_ACTIVE) }));
		labelalpha = lerp(global::a_text_secondary, global::a_text_main, global::microani_arr.Value(e_microani_HOVER));
		labelalpha = lerp(labelalpha, global::a_accent, max({ inputfocus, global::microani_arr.Value(e_microani_ACTIVE) }));
		draw_set_font(sInt(font_label));
		VarType labelshort = string_limit(text_get({ name }), sVar(dw) - draggerwid);
		draw_label(self, { labelshort, xx, yy + sReal(ui_small_height) / 2.0, fa_left, fa_middle, labelcolor, labelalpha });
		if (string_width(labelshort) < sVar(dw))
			draw_help_circle(self, tip, xx + string_width(labelshort) + IntType(4), yy + IntType(2), false);
		if (compact > 0)
			return IntType(0);
		yy += IntType(24);
		linex = xx;
		linewid = wid;
		trackx = linex + IntType(6);
		trackwid = linewid - IntType(12);
		context_menu_area(self, { linex, yy, linewid, thumbhei, /*"contextmenuvalue"*/ STR(1066), value, e_context_type_NUMBER, script, def });
		if (slidermouseon)
		{
			sInt(mouse_cursor) = cr_handpoint;
			if (sBool(mouse_left_pressed))
			{
				sVar(window_busy) = name;
				sVar(window_focus) = name;
				sVar(meter_drag_value) = value;
			}
		}
		if (sVar(window_busy) == name)
		{
			sInt(mouse_cursor) = cr_handpoint;
			if (global::_app->setting_unlimited_values > 0)
				sVar(meter_drag_value) = (minval + (gmlGlobal::mouse_x - linex) * (max({ IntType(1), (maxval - minval) }) / linewid));
			else
				sVar(meter_drag_value) = clamp(minval + (gmlGlobal::mouse_x - linex) * (max({ IntType(1), (maxval - minval) }) / linewid), minval, maxval);
			
			RealType d = snap(sVar(meter_drag_value), snapval) - value;
			if (d != IntType(0))
				script_execute(self, { script, d, true });
			if (!sBool(mouse_left))
			{
				sVar(window_busy) = /*""*/ STR(0);
				app_mouse_clear(self);
			}
		}
		dragval = (sVar(window_busy) == name ? sVar(meter_drag_value) : value);
		if (locked)
			dragx = .5 * linewid;
		else
			dragx = floor(percent(dragval, minval, maxval) * trackwid);
		
		dragy = yy + thumbhei / 2.0;
		VarType pos = trackx + dragx - IntType(6);
		RealType markers = floor((maxval - minval) / snapval);
		if (markers <= IntType(64) && !locked)
		{
			if (((RealType)linewid / markers) > IntType(20))
			{
				for (RealType i = IntType(0); i < markers + IntType(1); i++)
					draw_line_ext(linex + (linewid * (i / markers)), dragy - IntType(6), linex + (linewid * (i / markers)), dragy + IntType(6), global::c_border, global::a_border);
			}
			dragx = snap(floor(percent(dragval, minval, maxval) * linewid), ((RealType)linewid / markers));
			pos = clamp(trackx + dragx - IntType(6), trackx, trackx + trackwid) - IntType(6);
		}
		IntType color;
		RealType alpha;
		color = merge_color((IntType)(global::c_text_tertiary), (IntType)(global::c_text_secondary), max({ global::microani_arr.Value(e_microani_HOVER), global::microani_arr.Value(e_microani_ACTIVE), global::microani_arr.Value(e_microani_PRESS) }));
		color = merge_color(color, (IntType)(global::c_border), global::microani_arr.Value(e_microani_DISABLED));
		alpha = lerp(global::a_text_tertiary, global::a_text_secondary, max({ global::microani_arr.Value(e_microani_HOVER), global::microani_arr.Value(e_microani_ACTIVE), global::microani_arr.Value(e_microani_PRESS) }));
		alpha = lerp(alpha, global::a_border, global::microani_arr.Value(e_microani_DISABLED));
		draw_box(linex + (pos - linex), dragy - IntType(1), linewid - (pos - linex), IntType(2), false, color, alpha);
		color = merge_color((IntType)(global::c_accent), (IntType)(global::c_text_tertiary), global::microani_arr.Value(e_microani_DISABLED));
		alpha = merge_color((IntType)(global::a_accent), (IntType)(global::a_text_tertiary), global::microani_arr.Value(e_microani_DISABLED));
		draw_box(linex, dragy - IntType(1), pos - linex, IntType(2), false, color, alpha);
		color = merge_color((IntType)(global::c_accent), global::c_accent_hover, global::microani_arr.Value(e_microani_HOVER));
		color = merge_color(color, global::c_accent_pressed, max({ global::microani_arr.Value(e_microani_ACTIVE), global::microani_arr.Value(e_microani_PRESS) }));
		color = merge_color(color, (IntType)(global::c_text_tertiary), global::microani_arr.Value(e_microani_DISABLED));
		alpha = lerp(1.0, global::a_text_tertiary, global::microani_arr.Value(e_microani_DISABLED));
		draw_box(pos, dragy - IntType(10), IntType(12), IntType(20), false, global::c_level_middle, IntType(1));
		draw_box(pos, dragy - IntType(10), IntType(12), IntType(20), false, color, alpha);
		draw_box_bevel({ pos, dragy - IntType(10), IntType(12), IntType(20), IntType(1) });
		draw_box_hover({ pos, dragy - IntType(10), IntType(12), IntType(20), global::microani_arr.Value(e_microani_ACTIVE) });
		return 0.0;
	}
	
	RealType draw_meter_range(ScopeAny self, StringType name, VarType xx, VarType yy, RealType wid, RealType minrange, RealType maxrange, RealType snapval, VarType minval, VarType maxval, RealType mindef, RealType maxdef, IntType mintbx, IntType maxtbx, IntType minscript, IntType maxscript)
	{
		RealType thumbhei, hei, linewid, trackwid;
		BoolType mouseon, slidermouseon, minmouseon, maxmouseon;
		VarType textfocus, linex, trackx, thumby, minthumbpos, maxthumbpos;
		thumbhei = IntType(20);
		hei = (thumbhei + IntType(24));
		if (xx + wid < sVar(content_x) || xx > sVar(content_x) + sVar(content_width) || yy + hei < sVar(content_y) || yy > sVar(content_y) + sVar(content_height))
			return IntType(0);
		mouseon = app_mouse_box(self, xx, yy, wid, hei) && sBool(content_mouseon);
		slidermouseon = app_mouse_box(self, xx, yy + IntType(24), wid, thumbhei) && sBool(content_mouseon);
		microani_set(name, null_, false, false, false);
		textfield_group_add(self, { name + /*"mininput"*/ STR(1083), minval, mindef, minscript, X_, mintbx, null_, 0.1, minrange, min({ maxval, maxrange }) });
		textfield_group_add(self, { name + /*"maxinput"*/ STR(1084), maxval, maxdef, maxscript, X_, maxtbx, null_, 0.1, max({ minval, minrange }), maxrange });
		draw_textfield_group(self, name, (xx + wid - IntType(128)) + IntType(8), yy, IntType(128), IntType(0), null_, null_, snapval, false, false, IntType(0), true);
		textfocus = global::microani_arr.Value(e_microani_CUSTOM);
		microani_set(name, null_, sVar(window_busy) == name + /*"min"*/ STR(1085) || sVar(window_busy) == name + /*"max"*/ STR(1086) || slidermouseon, slidermouseon && sBool(mouse_left), false, false, IntType(1), false);
		microani_update({ sVar(window_busy) == name + /*"min"*/ STR(1085) || sVar(window_busy) == name + /*"max"*/ STR(1086) || slidermouseon, slidermouseon && sBool(mouse_left), sVar(window_busy) == name + /*"min"*/ STR(1085) || sVar(window_busy) == name + /*"max"*/ STR(1086), false, mouseon || textfocus > 0 });
		IntType labelcolor;
		RealType labelalpha;
		labelcolor = merge_color((IntType)(global::c_text_secondary), (IntType)(global::c_text_main), global::microani_arr.Value(e_microani_HOVER));
		labelcolor = merge_color(labelcolor, (IntType)(global::c_accent), max({ textfocus, global::microani_arr.Value(e_microani_ACTIVE) }));
		labelalpha = lerp(global::a_text_secondary, global::a_text_main, global::microani_arr.Value(e_microani_HOVER));
		labelalpha = lerp(labelalpha, global::a_accent, max({ textfocus, global::microani_arr.Value(e_microani_ACTIVE) }));
		draw_set_font(sInt(font_label));
		draw_label(self, { string_limit(text_get({ name }), wid - IntType(128)), xx, yy + (sReal(ui_small_height) / 2.0), fa_left, fa_middle, labelcolor, labelalpha });
		if (sReal(window_compact) > 0 || global::_app->panel_compact > 0)
			return IntType(0);
		yy += IntType(24);
		linex = xx;
		linewid = wid;
		trackx = linex + IntType(6);
		trackwid = linewid - IntType(12);
		thumby = yy + thumbhei / 2.0;
		minthumbpos = (sVar(window_busy) == name + /*"min"*/ STR(1085) ? sVar(meter_drag_value) : minval);
		minthumbpos = trackx + floor(percent(minthumbpos, minrange, maxrange) * trackwid) - IntType(6);
		maxthumbpos = (sVar(window_busy) == name + /*"max"*/ STR(1086) ? sVar(meter_drag_value) : maxval);
		maxthumbpos = trackx + floor(percent(maxthumbpos, minrange, maxrange) * trackwid) - IntType(6);
		minmouseon = app_mouse_box(self, minthumbpos, thumby - IntType(10), IntType(12), IntType(20)) && sBool(content_mouseon);
		maxmouseon = app_mouse_box(self, maxthumbpos, thumby - IntType(10), IntType(12), IntType(20)) && sBool(content_mouseon);
		if (slidermouseon && sVar(window_busy) == /*""*/ STR(0))
		{
			if (minmouseon || maxmouseon)
				sInt(mouse_cursor) = cr_handpoint;
			if (sBool(mouse_left_pressed))
			{
				if (minmouseon)
				{
					sVar(window_busy) = name + /*"min"*/ STR(1085);
					sVar(meter_drag_value) = minval;
				}
				else
					if (maxmouseon)
					{
						sVar(window_busy) = name + /*"max"*/ STR(1086);
						sVar(meter_drag_value) = maxval;
					}
				
				sVar(window_focus) = name;
			}
			if (sBool(mouse_right_pressed))
			{
				script_execute(self, { minscript, mindef, false });
				script_execute(self, { maxscript, maxdef, false });
			}
		}
		if (sVar(window_busy) == name + /*"min"*/ STR(1085) || sVar(window_busy) == name + /*"max"*/ STR(1086))
		{
			sInt(mouse_cursor) = cr_handpoint;
			if (global::_app->setting_unlimited_values > 0)
				sVar(meter_drag_value) = minrange + (gmlGlobal::mouse_x - linex) * (max({ IntType(1), (maxrange - minrange) }) / linewid);
			else
				sVar(meter_drag_value) = clamp(minrange + (gmlGlobal::mouse_x - linex) * (max({ IntType(1), (maxrange - minrange) }) / linewid), minrange, maxrange);
			
			if (sVar(window_busy) == name + /*"min"*/ STR(1085))
			{
				RealType d = min({ snap(sVar(meter_drag_value), snapval), maxval }) - minval;
				if (d != IntType(0))
					script_execute(self, { minscript, d, true });
			}
			else
			{
				RealType d = max({ snap(sVar(meter_drag_value), snapval), minval }) - maxval;
				if (d != IntType(0))
					script_execute(self, { maxscript, d, true });
			}
			
			if (!sBool(mouse_left))
			{
				sVar(window_busy) = /*""*/ STR(0);
				app_mouse_clear(self);
			}
		}
		if (sVar(window_busy) == name + /*"min"*/ STR(1085))
			minthumbpos = min({ minthumbpos, maxthumbpos });
		if (sVar(window_busy) == name + /*"max"*/ STR(1086))
			maxthumbpos = max({ minthumbpos, maxthumbpos });
		IntType color;
		RealType alpha;
		color = merge_color((IntType)(global::c_text_tertiary), (IntType)(global::c_text_secondary), max({ global::microani_arr.Value(e_microani_HOVER), global::microani_arr.Value(e_microani_ACTIVE), global::microani_arr.Value(e_microani_PRESS) }));
		color = merge_color(color, (IntType)(global::c_border), global::microani_arr.Value(e_microani_DISABLED));
		alpha = lerp(global::a_text_tertiary, global::a_text_secondary, max({ global::microani_arr.Value(e_microani_HOVER), global::microani_arr.Value(e_microani_ACTIVE), global::microani_arr.Value(e_microani_PRESS) }));
		alpha = lerp(alpha, global::a_border, global::microani_arr.Value(e_microani_DISABLED));
		draw_box(linex, thumby - IntType(1), minthumbpos - linex, IntType(2), false, color, alpha);
		draw_box(maxthumbpos, thumby - IntType(1), (linex + linewid) - maxthumbpos, IntType(2), false, color, alpha);
		color = merge_color((IntType)(global::c_accent), (IntType)(global::c_text_tertiary), global::microani_arr.Value(e_microani_DISABLED));
		alpha = merge_color((IntType)(global::a_accent), (IntType)(global::a_text_tertiary), global::microani_arr.Value(e_microani_DISABLED));
		draw_box(minthumbpos, thumby - IntType(1), maxthumbpos - minthumbpos, IntType(2), false, color, alpha);
		microani_set(name + /*"min"*/ STR(1085), minscript, (sVar(window_busy) == name + /*"min"*/ STR(1085)) || minmouseon, minmouseon && sBool(mouse_left), false);
		microani_update({ (sVar(window_busy) == name + /*"min"*/ STR(1085)) || minmouseon, minmouseon && sBool(mouse_left), false });
		color = merge_color((IntType)(global::c_accent), global::c_accent_hover, global::microani_arr.Value(e_microani_HOVER));
		color = merge_color(color, global::c_accent_pressed, max({ global::microani_arr.Value(e_microani_ACTIVE), global::microani_arr.Value(e_microani_PRESS) }));
		color = merge_color(color, (IntType)(global::c_text_tertiary), global::microani_arr.Value(e_microani_DISABLED));
		alpha = lerp(1.0, global::a_text_tertiary, global::microani_arr.Value(e_microani_DISABLED));
		draw_box(minthumbpos, thumby - IntType(10), IntType(12), IntType(20), false, global::c_level_middle, IntType(1));
		draw_box(minthumbpos, thumby - IntType(10), IntType(12), IntType(20), false, color, alpha);
		draw_box_bevel({ minthumbpos, thumby - IntType(10), IntType(12), IntType(20), IntType(1) });
		draw_box_hover({ minthumbpos, thumby - IntType(10), IntType(12), IntType(20), global::microani_arr.Value(e_microani_ACTIVE) });
		microani_set(name + /*"max"*/ STR(1086), maxscript, (sVar(window_busy) == name + /*"max"*/ STR(1086)) || maxmouseon, maxmouseon && sBool(mouse_left), false);
		microani_update({ (sVar(window_busy) == name + /*"max"*/ STR(1086)) || maxmouseon, maxmouseon && sBool(mouse_left), false });
		color = merge_color((IntType)(global::c_accent), global::c_accent_hover, global::microani_arr.Value(e_microani_HOVER));
		color = merge_color(color, global::c_accent_pressed, max({ global::microani_arr.Value(e_microani_ACTIVE), global::microani_arr.Value(e_microani_PRESS) }));
		color = merge_color(color, (IntType)(global::c_text_tertiary), global::microani_arr.Value(e_microani_DISABLED));
		alpha = lerp(1.0, global::a_text_tertiary, global::microani_arr.Value(e_microani_DISABLED));
		draw_box(maxthumbpos, thumby - IntType(10), IntType(12), IntType(20), false, global::c_level_middle, IntType(1));
		draw_box(maxthumbpos, thumby - IntType(10), IntType(12), IntType(20), false, color, alpha);
		draw_box_bevel({ maxthumbpos, thumby - IntType(10), IntType(12), IntType(20), IntType(1) });
		draw_box_hover({ maxthumbpos, thumby - IntType(10), IntType(12), IntType(20), global::microani_arr.Value(e_microani_ACTIVE) });
		return 0.0;
	}
	
	void draw_missing(RealType xx, RealType yy, VarType w, VarType h)
	{
		draw_box(xx, yy, w, h, false, c_fuchsia, IntType(1));
		draw_box(xx + (RealType)w / 2.0, yy, (RealType)w / 2.0, (RealType)h / 2.0, false, c_black, IntType(1));
		draw_box(xx, yy + (RealType)h / 2.0, (RealType)w / 2.0, (RealType)h / 2.0, false, c_black, IntType(1));
	}
	
	RealType draw_outline(VarType xx, VarType yy, VarType ww, VarType hh, RealType size, VarType incolor, VarType inalpha, RealType inline_)
	{
		VarType color;
		RealType alpha;
		color = draw_get_color();
		alpha = draw_get_alpha();
		if (!is_undefined(incolor))
		{
			color = incolor;
			alpha *= inalpha;
			if (alpha == IntType(0))
				return IntType(0);
		}
		if (inline_ > 0)
		{
			xx += size;
			yy += size;
			ww -= size * IntType(2);
			hh -= size * IntType(2);
		}
		draw_box(xx - size, yy - size, ww + (size * IntType(2)), size, false, color, alpha);
		draw_box(xx - size, yy + hh, ww + (size * IntType(2)), size, false, color, alpha);
		draw_box(xx - size, yy, size, hh, false, color, alpha);
		draw_box(xx + ww, yy, size, hh, false, color, alpha);
		return 0.0;
	}
	
	void draw_pattern(IntType xx, RealType yy, RealType w, RealType h)
	{
		RealType ypos;
		IntType pattern;
		pattern = (global::_app->setting_theme == global::theme_light ? IntType(0) : IntType(1));
		ypos = yy;
		while (ypos < yy + h)
		{
			draw_sprite_ext(ID_spr_pattern_left, pattern, xx, (IntType)(ypos), 80.0, 80.0, 0.0, c_white, 1.0);
			ypos += (sprite_get_height(ID_spr_pattern_left) * IntType(80));
		}
		
		ypos = yy;
		while (ypos < yy + h)
		{
			draw_sprite_ext(ID_spr_pattern_right, pattern, xx + w, (IntType)(ypos), 80.0, 80.0, 0.0, c_white, 1.0);
			ypos += (sprite_get_height(ID_spr_pattern_right) * IntType(80));
		}
		
	}
	
	BoolType draw_radiobutton(ScopeAny self, StringType name, VarType xx, VarType yy, IntType value, BoolType active, IntType script)
	{
		VarType text;
		RealType w, h;
		BoolType pressed;
		text = text_get({ name });
		draw_set_font(sInt(font_label));
		w = sReal(ui_small_height) + string_width(name);
		h = sReal(ui_small_height);
		BoolType mouseon, mouseclick;
		mouseon = app_mouse_box(self, xx, yy, w, h) && sBool(content_mouseon) && (sVar(window_busy) == /*""*/ STR(0));
		mouseclick = mouseon && sBool(mouse_left);
		pressed = false;
		if (mouseon)
		{
			if (sBool(mouse_left) || sBool(mouse_left_released))
				pressed = true;
			sInt(mouse_cursor) = cr_handpoint;
		}
		microani_set(name, script, mouseon, mouseclick, active);
		VarType buttonx, buttony;
		buttonx = xx + IntType(10);
		buttony = (yy + (sReal(ui_small_height) / 2.0));
		IntType buttoncolor = merge_color((IntType)(global::c_text_secondary), (IntType)(global::c_accent), global::microani_arr.Value(e_microani_PRESS));
		buttoncolor = merge_color(buttoncolor, (IntType)(global::c_accent), global::microani_arr.Value(e_microani_ACTIVE));
		RealType buttonalpha = lerp(global::a_text_secondary, 1.0, global::microani_arr.Value(e_microani_PRESS));
		buttonalpha = lerp(buttonalpha, 1.0, global::microani_arr.Value(e_microani_ACTIVE));
		draw_image({ ID_spr_radiobutton, IntType(0), buttonx, buttony, IntType(1), IntType(1), buttoncolor, buttonalpha * (IntType(1) - global::microani_arr.Value(e_microani_ACTIVE)) * (IntType(1) - global::microani_arr.Value(e_microani_HOVER)) });
		draw_image({ ID_spr_radiobutton, IntType(1), buttonx, buttony, IntType(1), IntType(1), buttoncolor, buttonalpha * (IntType(1) - global::microani_arr.Value(e_microani_ACTIVE)) * (global::microani_arr.Value(e_microani_HOVER)) });
		draw_image({ ID_spr_radiobutton, IntType(2), buttonx, buttony, IntType(1), IntType(1), buttoncolor, buttonalpha * global::microani_arr.Value(e_microani_ACTIVE) * (IntType(1) - global::microani_arr.Value(e_microani_RADIO_HOVER)) });
		draw_image({ ID_spr_radiobutton_hover, IntType(0), buttonx, buttony, IntType(1), IntType(1), global::c_accent_hover, global::a_accent_hover * global::microani_arr.Value(e_microani_HOVER) });
		draw_label(self, { text, xx + IntType(28), yy + h / 2.0, fa_left, fa_middle, global::c_text_secondary, global::a_text_secondary, sInt(font_value) });
		microani_update({ mouseon, mouseclick, active });
		if (pressed && sBool(mouse_left_released))
		{
			if (script != null_)
				script_execute(self, { script, value });
			return true;
		}
		return false;
	}
	
	RealType draw_recent(ScopeAny self, VarArgs argument)
	{
		IntType argument_count = argument.Size();
		VarType xx, yy, wid, hei, mode, recenty;
		BoolType mouseon;
		xx = argument[IntType(0)];
		yy = argument[IntType(1)];
		wid = argument[IntType(2)];
		hei = argument[IntType(3)];
		mode = sStr(recent_display_mode);
		if (argument_count > IntType(4))
			mode = argument[IntType(4)];
		recenty = yy;
		if (mode == /*"simple"*/ STR(1087))
		{
			draw_set_font(sInt(font_value));
			for (IntType i = IntType(0); i < sReal(recent_list_amount); i++)
			{
				BoolType hover = app_mouse_box(self, xx, recenty, wid, IntType(44)) && !sBool(popup_mouseon) && !sBool(toast_mouseon) && !sBool(context_menu_mouseon);
				BoolType mouseon = hover;
				VarType item = DsList(sInt(recent_list)).Value(i);
				VarType iconx = xx + wid - IntType(8);
				iconx -= 24.0;
				if (hover)
				{
					if (draw_button_icon(self, { /*"recentdelete"*/ STR(1088) + string(item), iconx, recenty + IntType(8), IntType(24), IntType(24), false, icons_DELETE, null_, false, /*"tooltipremove"*/ STR(1089) }))
						action_recent_remove(item);
					mouseon = mouseon && !app_mouse_box(self, iconx, recenty + IntType(8), IntType(24), IntType(24));
				}
				iconx -= 24.0;
				draw_label(self, { string_limit(filename_name(idVar(item, name)), (iconx - xx) - IntType(12)), xx + IntType(12), recenty + IntType(22), fa_left, fa_middle, global::c_text_main, global::a_text_main });
				draw_box(xx + IntType(4), recenty + IntType(43), wid - IntType(8), IntType(1), false, global::c_overlay, global::a_overlay);
				microani_set(/*"recent"*/ STR(1090) + string(item), null_, mouseon, mouseon && sBool(mouse_left), false);
				draw_box(xx, recenty, wid, IntType(44), false, global::c_overlay, global::a_overlay * global::microani_arr.Value(e_microani_HOVER));
				draw_box_hover({ xx, recenty, wid, IntType(44), global::microani_arr.Value(e_microani_HOVER) });
				draw_box(xx, recenty, wid, IntType(44), false, global::c_accent_overlay, global::a_accent_overlay * global::microani_arr.Value(e_microani_PRESS));
				microani_update({ mouseon, mouseon && sBool(mouse_left), false });
				if (mouseon)
				{
					sInt(mouse_cursor) = cr_handpoint;
					if (sBool(mouse_left_released))
					{
						if (file_exists_lib(idVar(item, filename)))
						{
							project_load(self, { idVar(item, filename) });
							sStr(window_state) = /*""*/ STR(0);
							return IntType(0);
						}
						else
							error(/*"erroropenprojectexists"*/ STR(73));
						
					}
				}
				recenty += IntType(44);
				if (recenty + IntType(44) > yy + hei)
					break;
			}
		}
		if (mode == /*"list"*/ STR(1091))
		{
			draw_set_font(sInt(font_label));
			VarType liststart = IntType(0);
			if ((sReal(recent_list_amount) * IntType(44)) > hei - IntType(28))
			{
				sStr(window_scroll_focus) = string(sInt(recent_scrollbar));
				scrollbar_draw(self, sInt(recent_scrollbar), e_scroll_VERTICAL, xx + wid - IntType(12), yy + IntType(28), hei - IntType(28), sReal(recent_list_amount) * IntType(44));
				liststart = snap((RealType)ObjType(obj_scrollbar, sInt(recent_scrollbar))->value / 44.0, IntType(1));
				wid -= 12.0;
			}
			if (hei < IntType(28))
				return IntType(0);
			RealType namewidth, timewidth;
			VarType namex, timex;
			namewidth = (wid - (IntType(12) * IntType(3))) / 2.0;
			timewidth = (wid - (IntType(12) * IntType(3))) / 2.0;
			namex = xx + IntType(12);
			timex = xx + IntType(12) + namewidth + IntType(12);
			draw_label(self, { text_get({ /*"recentfilename"*/ STR(1092) }), namex, recenty + IntType(14), fa_left, fa_middle, global::c_text_secondary, global::a_text_secondary });
			draw_label(self, { text_get({ /*"recentlastopened"*/ STR(1093) }), timex, recenty + IntType(14), fa_left, fa_middle, global::c_text_secondary, global::a_text_secondary });
			recenty += IntType(28);
			draw_set_font(sInt(font_value));
			for (VarType i = liststart; i < sReal(recent_list_amount); i++)
			{
				BoolType hover = app_mouse_box(self, xx, recenty, wid, IntType(44)) && !sBool(popup_mouseon) && !sBool(toast_mouseon) && !sBool(context_menu_mouseon);
				mouseon = hover;
				VarType item = DsList(sInt(recent_list_display)).Value(i);
				draw_label(self, { string_limit(filename_name(idVar(item, name)), namewidth), xx + IntType(12), recenty + IntType(22), fa_left, fa_middle, global::c_text_main, global::a_text_main });
				draw_label(self, { string_limit(recent_time_string(idVar(item, last_opened)), timewidth), timex, recenty + IntType(22), fa_left, fa_middle, global::c_text_secondary, global::a_text_secondary });
				VarType iconx = xx + wid - IntType(8);
				iconx -= 24.0;
				if (hover)
				{
					if (draw_button_icon(self, { /*"recentdelete"*/ STR(1088) + string(item), iconx, recenty + IntType(8), IntType(24), IntType(24), false, icons_DELETE, null_, false, /*"tooltipremove"*/ STR(1089) }))
						action_recent_remove(item);
					mouseon = mouseon && !app_mouse_box(self, iconx, recenty + IntType(8), IntType(24), IntType(24));
				}
				iconx -= 24.0;
				if (hover || idVar(item, pinned) > 0)
				{
					if (draw_button_icon(self, { /*"recentpin"*/ STR(1094) + string(item), iconx, recenty + IntType(8), IntType(24), IntType(24), idVar(item, pinned), icons_PIN, null_, false, /*"tooltippin"*/ STR(1095) }))
						action_recent_pin(item);
					mouseon = mouseon && !app_mouse_box(self, iconx, recenty + IntType(8), IntType(24), IntType(24));
				}
				draw_box(xx + IntType(4), recenty + IntType(43), wid - IntType(8), IntType(1), false, global::c_overlay, global::a_overlay);
				microani_set(/*"recent"*/ STR(1090) + string(item), null_, mouseon, mouseon && sBool(mouse_left), false);
				draw_box(xx, recenty, wid, IntType(44), false, global::c_overlay, global::a_overlay * global::microani_arr.Value(e_microani_HOVER));
				draw_box_hover({ xx, recenty, wid, IntType(44), global::microani_arr.Value(e_microani_HOVER) });
				draw_box(xx, recenty, wid, IntType(44), false, global::c_accent_overlay, global::a_accent_overlay * global::microani_arr.Value(e_microani_PRESS));
				microani_update({ mouseon, mouseon && sBool(mouse_left), false });
				if (mouseon)
				{
					sInt(mouse_cursor) = cr_handpoint;
					if (sBool(mouse_left_released))
					{
						if (file_exists_lib(idVar(item, filename)))
						{
							project_load(self, { idVar(item, filename) });
							sStr(window_state) = /*""*/ STR(0);
							return IntType(0);
						}
						else
							error(/*"erroropenprojectexists"*/ STR(73));
						
					}
				}
				recenty += IntType(44);
				if (recenty + IntType(44) > yy + hei)
					break;
			}
		}
		if (mode == /*"grid"*/ STR(636))
		{
			VarType liststart = IntType(0);
			if ((sReal(recent_list_amount) * IntType(256)) > hei)
			{
				sStr(window_scroll_focus) = string(sInt(recent_scrollbar));
				scrollbar_draw(self, sInt(recent_scrollbar), e_scroll_VERTICAL, xx + wid + IntType(12), yy, hei, ceil(sReal(recent_list_amount) / 4.0) * IntType(256));
				liststart = ObjType(obj_scrollbar, sInt(recent_scrollbar))->value;
			}
			VarType cardx, item;
			RealType cardy;
			BoolType areamouseon, hover, mouseon;
			cardx = sVar(dx);
			cardy = sVar(dy) - liststart;
			areamouseon = app_mouse_box(self, xx, yy, wid, hei);
			clip_begin(xx - IntType(2), yy - IntType(1), wid + IntType(4), hei + IntType(2));
			for (IntType i = IntType(0); i < sReal(recent_list_amount); i++)
			{
				if (cardy < yy + hei || cardy + IntType(240) + IntType(16) > yy)
				{
					item = DsList(sInt(recent_list_display)).Value(i);
					hover = areamouseon && app_mouse_box(self, cardx, cardy, IntType(240), IntType(240)) && !sBool(popup_mouseon) && !sBool(toast_mouseon) && !sBool(context_menu_mouseon);
					mouseon = hover;
					microani_set(/*"recent"*/ STR(1090) + string(item), null_, mouseon, mouseon && sBool(mouse_left), false);
					draw_box(cardx, cardy, IntType(240), IntType(240), false, global::c_overlay, global::a_overlay * global::microani_arr.Value(e_microani_HOVER));
					draw_box_hover({ cardx, cardy, IntType(240), IntType(240), global::microani_arr.Value(e_microani_HOVER) });
					draw_box(cardx, cardy, IntType(240), IntType(240), false, global::c_accent_overlay, global::a_accent_overlay * global::microani_arr.Value(e_microani_PRESS));
					draw_outline(cardx, cardy, IntType(240), IntType(240), IntType(1), (idVar(item, pinned) > 0) ? global::c_accent : global::c_border, (idVar(item, pinned) > 0) ? 1.0 : global::a_border);
					if (idVar(item, thumbnail) != null_)
						draw_sprite((IntType)(idVar(item, thumbnail)), IntType(0), (IntType)(cardx), (IntType)(cardy));
					else
						draw_sprite(ID_spr_missing_thumbnail, IntType(0), (IntType)(cardx), (IntType)(cardy));
					
					RealType iconwid;
					VarType iconx;
					iconwid = IntType(4) + ((IntType)(hover || idVar(item, pinned) > 0) * IntType(28)) + ((IntType)hover * IntType(28));
					iconx = cardx + IntType(240) - IntType(12) - IntType(24);
					mouseon = mouseon && !app_mouse_box(self, cardx + IntType(240) - iconwid - IntType(8), cardy + IntType(8), iconwid, IntType(32));
					if (hover || idVar(item, pinned) > 0)
					{
						draw_box(cardx + IntType(240) - iconwid - IntType(8), cardy + IntType(8), iconwid, IntType(32), false, global::c_level_middle, IntType(1));
						draw_outline(cardx + IntType(240) - iconwid - IntType(8), cardy + IntType(8), iconwid, IntType(32), IntType(1), global::c_border, global::a_border, true);
					}
					if (hover || idVar(item, pinned) > 0)
					{
						if (draw_button_icon(self, { /*"recentpin"*/ STR(1094) + string(item), iconx, cardy + IntType(12), IntType(24), IntType(24), idVar(item, pinned), icons_PIN, null_, false, /*"tooltippin"*/ STR(1095), null_ }))
							action_recent_pin(item);
					}
					iconx -= 28.0;
					if (hover)
					{
						if (draw_button_icon(self, { /*"recentdelete"*/ STR(1088), iconx, cardy + IntType(12), IntType(24), IntType(24), false, icons_DELETE, null_, false, /*"tooltipremove"*/ STR(1089), null_ }))
							action_recent_remove(item);
					}
					microani_set(/*"recent"*/ STR(1090) + string(item), null_, mouseon, mouseon && sBool(mouse_left), false);
					microani_update({ hover, hover && sBool(mouse_left), false });
					draw_set_font(sInt(font_value));
					draw_label(self, { string_limit(idVar(item, name), IntType(210)), cardx + IntType(15), cardy + IntType(209), fa_left, fa_bottom, global::c_text_main, global::a_text_main });
					draw_label(self, { recent_time_string(idVar(item, last_opened)), cardx + IntType(15), cardy + IntType(228), fa_left, fa_bottom, global::c_text_secondary, global::a_text_secondary });
					if (mouseon)
					{
						sInt(mouse_cursor) = cr_handpoint;
						if (sBool(mouse_left_released))
						{
							if (file_exists_lib(idVar(item, filename)))
							{
								project_load(self, { idVar(item, filename) });
								sStr(window_state) = /*""*/ STR(0);
								return IntType(0);
							}
							else
								error(/*"erroropenprojectexists"*/ STR(73));
							
						}
					}
				}
				cardx += IntType(240) + IntType(16);
				if (cardx > (xx + wid))
				{
					cardx = sVar(dx);
					cardy += IntType(240) + IntType(16);
				}
			}
			clip_end();
			RealType gradalpha = .25 * percent(liststart, IntType(0), IntType(25));
			draw_gradient(xx, yy - IntType(1), wid, IntType(16), c_black, gradalpha, gradalpha, IntType(0), IntType(0));
		}
		if (sBool(recent_list_update))
		{
			recent_update(self);
			sBool(recent_list_update) = false;
		}
		return 0.0;
	}
	
	void draw_separator_vertical(VarType xx, VarType yy, RealType hei)
	{
		RealType alpha = draw_get_alpha();
		draw_set_alpha(alpha * global::a_border);
		render_set_culling(false);
		draw_line_width_color((IntType)(xx), (IntType)(yy), (IntType)(xx), (IntType)(yy + hei), IntType(1), (IntType)(global::c_border), (IntType)(global::c_border));
		render_set_culling(true);
		draw_set_alpha(alpha);
	}
	
	void draw_subheader(ScopeAny self, VarType cat, VarType xx, VarType yy, RealType w, RealType h)
	{
		BoolType mouseon;
		VarType cap, iconframe;
		draw_set_font(sInt(font_subheading));
		cap = string_limit(text_get({ ObjType(obj_category, cat)->name }), sVar(dw) - (h + IntType(4)));
		mouseon = app_mouse_box(self, xx, yy, w, h) && sBool(content_mouseon);
		microani_set(ObjType(obj_category, cat)->name + /*"close"*/ STR(1096), null_, false, false, ObjType(obj_category, cat)->show, false);
		IntType color;
		RealType alpha, frame;
		VarType focus;
		focus = max({ global::microani_arr.Value(e_microani_ACTIVE), global::microani_arr.Value(e_microani_PRESS) });
		color = merge_color((IntType)(global::c_text_tertiary), (IntType)(global::c_text_secondary), global::microani_arr.Value(e_microani_HOVER));
		color = merge_color(color, (IntType)(global::c_accent), focus);
		color = merge_color(color, global::c_accent_hover, global::microani_arr.Value(e_microani_HOVER) * global::microani_arr.Value(e_microani_ACTIVE));
		color = merge_color(color, global::c_accent_pressed, global::microani_arr.Value(e_microani_PRESS) * global::microani_arr.Value(e_microani_ACTIVE));
		alpha = lerp(global::a_text_tertiary, global::a_text_secondary, global::microani_arr.Value(e_microani_HOVER));
		alpha = lerp(alpha, global::a_accent, focus);
		frame = floor((sprite_get_number(ID_spr_chevron_ani) - IntType(1)) * global::microani_arr.Value(e_microani_ACTIVE));
		if (is_array(ObjType(obj_category, cat)->icon))
			iconframe = (ObjType(obj_theme, sInt(setting_theme))->dark ? ObjType(obj_category, cat)->icon.Value(IntType(1)) : ObjType(obj_category, cat)->icon.Value(IntType(0)));
		else
			iconframe = ObjType(obj_category, cat)->icon;
		
		draw_image({ ID_spr_chevron_ani, frame, xx + w - IntType(11), yy + h / 2.0, IntType(1), IntType(1), color, alpha });
		if (global::_app->panel_compact > 0)
			draw_label(self, { cap, xx + IntType(4), yy + (h / 2.0) - IntType(1), fa_left, fa_middle, color, alpha });
		else
		{
			draw_image({ ID_spr_icons, iconframe, xx + IntType(12), yy + h / 2.0, IntType(1), IntType(1), color, alpha });
			draw_label(self, { cap, xx + IntType(26), yy + (h / 2.0) - IntType(1), fa_left, fa_middle, color, alpha });
		}
		
		microani_update({ mouseon, (mouseon && sBool(mouse_left)), ObjType(obj_category, cat)->show });
		if (mouseon)
		{
			sInt(mouse_cursor) = cr_handpoint;
			if (sBool(mouse_left_released))
				ObjType(obj_category, cat)->show = !(ObjType(obj_category, cat)->show > 0);
		}
	}
	
	RealType draw_surface_box_center(VarType surf, RealType xx, RealType yy, VarType w, VarType h)
	{
		RealType sw, sh, scale;
		if (!surface_exists((IntType)(surf)))
			return IntType(0);
		sw = surface_get_width((IntType)(surf));
		sh = surface_get_height((IntType)(surf));
		if (sw / sh < (RealType)w / h)
		{
			scale = (RealType)h / sh;
			xx += (w - scale * sw) / 2.0;
			w = sw * scale;
		}
		else
		{
			scale = (RealType)w / sw;
			yy += (h - scale * sh) / 2.0;
			h = sh * scale;
		}
		
		xx = floor(xx);
		yy = floor(yy);
		w = ceil(w);
		h = ceil(h);
		draw_surface_ext((IntType)(surf), (IntType)(xx), (IntType)(yy), scale, scale, 0.0, c_white, 1.0);
		return 0.0;
	}
	
	void draw_surface_exists(VarType surf, VarType xx, VarType yy)
	{
		if (surface_exists((IntType)(surf)))
			draw_surface_ext((IntType)(surf), (IntType)(xx), (IntType)(yy), 1.0, 1.0, 0.0, c_white, draw_get_alpha());
	}
	
	void draw_surface_size(VarType surf, VarType xx, VarType yy, VarType w, VarType h)
	{
		if (surface_exists((IntType)(surf)))
			draw_surface_ext((IntType)(surf), (IntType)(xx), (IntType)(yy), (RealType)w / surface_get_width((IntType)(surf)), (RealType)h / surface_get_height((IntType)(surf)), 0.0, -IntType(1), draw_get_alpha());
		else
			draw_box(xx, yy, w, h, false, c_black, draw_get_alpha());
		
	}
	
	RealType draw_switch(ScopeAny self, StringType name, VarType xx, VarType yy, VarType active, IntType script, StringType tip, BoolType disabled)
	{
		VarType text, switchx, switchy, w;
		RealType h, thumbgoal;
		BoolType pressed;
		text = text_get({ name });
		w = sVar(dw);
		h = sReal(ui_small_height);
		switchx = (xx + sVar(dw) - IntType(22));
		switchy = (yy + (h / 2.0) - IntType(7));
		if (xx + w < sVar(content_x) || xx > sVar(content_x) + sVar(content_width) || yy + h < sVar(content_y) || yy > sVar(content_y) + sVar(content_height))
			return IntType(0);
		BoolType mouseon, mouseclick;
		mouseon = app_mouse_box(self, switchx, switchy, h, IntType(16)) && sBool(content_mouseon) && !disabled;
		mouseclick = mouseon && sBool(mouse_left);
		pressed = false;
		if (mouseon)
		{
			if (sBool(mouse_left) || sBool(mouse_left_released))
				pressed = true;
			sInt(mouse_cursor) = cr_handpoint;
		}
		if (pressed)
			thumbgoal = 0.5;
		else
			if (active > 0)
				thumbgoal = IntType(1);
			else
				thumbgoal = IntType(0);
		
		
		microani_set(name, script, mouseon, mouseclick, active, disabled, IntType(1), IntType(0), thumbgoal);
		IntType offcolor, oncolor, color;
		RealType offalpha, onalpha, alpha;
		offcolor = merge_color((IntType)(global::c_text_secondary), (IntType)(global::c_text_main), global::microani_arr.Value(e_microani_HOVER));
		offcolor = merge_color(offcolor, (IntType)(global::c_accent), global::microani_arr.Value(e_microani_PRESS));
		offalpha = lerp(global::a_text_secondary, global::a_text_main, global::microani_arr.Value(e_microani_HOVER));
		offalpha = lerp(offalpha, global::a_accent, global::microani_arr.Value(e_microani_PRESS));
		oncolor = merge_color((IntType)(global::c_accent), global::c_accent_hover, global::microani_arr.Value(e_microani_HOVER));
		oncolor = merge_color(oncolor, global::c_accent_pressed, global::microani_arr.Value(e_microani_PRESS));
		onalpha = lerp(global::a_accent, global::a_accent_hover, global::microani_arr.Value(e_microani_HOVER));
		onalpha = lerp(onalpha, global::a_accent_pressed, global::microani_arr.Value(e_microani_PRESS));
		color = merge_color(offcolor, oncolor, global::microani_arr.Value(e_microani_ACTIVE));
		alpha = lerp(offalpha, onalpha, global::microani_arr.Value(e_microani_ACTIVE));
		color = merge_color(color, (IntType)(global::c_text_tertiary), global::microani_arr.Value(e_microani_DISABLED));
		alpha = lerp(alpha, global::a_text_tertiary, global::microani_arr.Value(e_microani_DISABLED));
		draw_box(switchx, switchy, IntType(20), IntType(14), false, color, alpha);
		VarType buttonx, buttony;
		buttonx = switchx + IntType(2) + floor(IntType(8) * global::microani_arr.Value(e_microani_GOAL_EASE));
		buttony = switchy + IntType(2);
		draw_box(buttonx, buttony, IntType(8), IntType(10), false, global::c_button_text, IntType(1));
		draw_box_bevel({ buttonx, buttony, IntType(8), IntType(10), IntType(1), ObjType(obj_theme, sInt(setting_theme))->name == /*"light"*/ STR(637) });
		draw_box_hover({ switchx, switchy, IntType(20), IntType(14), global::microani_arr.Value(e_microani_PRESS) });
		draw_set_font(sInt(font_label));
		draw_label(self, { string_limit(text, w - IntType(32)), xx, yy + (h / 2.0), fa_left, fa_middle, lerp(global::c_text_secondary, global::c_text_tertiary, global::microani_arr.Value(e_microani_DISABLED)), lerp(global::a_text_secondary, global::a_text_tertiary, global::microani_arr.Value(e_microani_DISABLED)) });
		microani_update({ mouseon, mouseclick, active, disabled, IntType(0), thumbgoal });
		draw_help_circle(self, tip, xx + string_width(text) + IntType(4), yy + (h / 2.0) - IntType(10), disabled);
		if (pressed && sBool(mouse_left_released))
		{
			if (script != null_)
				script_execute(self, { script, !(active > 0) });
			return true;
		}
		return 0.0;
	}
	
	RealType draw_textfield(ScopeAny self, StringType name, VarType xx, VarType yy, VarType w, RealType h, IntType textbox, IntType script, VarType placeholder, StringType labelpos, BoolType err)
	{
		IntType capwidth;
		VarType fieldy;
		capwidth = IntType(0);
		fieldy = yy;
		draw_set_font(sInt(font_label));
		if (labelpos == /*"top"*/ STR(191))
			fieldy += (label_height + IntType(8));
		else
			if (labelpos == /*"none"*/ STR(899))
				capwidth = IntType(0);
			else
				capwidth = string_width(text_get({ name })) + IntType(8);
		
		
		if (xx + w < sVar(content_x) || xx > sVar(content_x) + sVar(content_width) || yy + h < sVar(content_y) || yy > sVar(content_y) + sVar(content_height))
		{
			if (sBool(textbox_jump))
				ds_list_add({ sInt(textbox_list), ArrType::From({ textbox, sVar(content_tab), yy, sVar(content_y), sVar(content_height) }) });
			return IntType(0);
		}
		RealType update = draw_inputbox(self, { name, xx + capwidth, fieldy, w - capwidth, h, placeholder, textbox, script, false, err });
		draw_set_font(sInt(font_label));
		VarType labelcolor;
		RealType labelalpha;
		labelcolor = merge_color((IntType)(global::c_text_secondary), (IntType)(global::c_text_main), global::microani_arr.Value(e_microani_HOVER));
		labelcolor = merge_color((IntType)(labelcolor), (IntType)(global::c_accent), global::microani_arr.Value(e_microani_ACTIVE));
		labelalpha = lerp(global::a_text_secondary, global::a_text_main, global::microani_arr.Value(e_microani_HOVER));
		labelalpha = lerp(labelalpha, global::a_accent, global::microani_arr.Value(e_microani_ACTIVE));
		if (err)
		{
			labelcolor = global::c_error;
			labelalpha = IntType(1);
		}
		if (labelpos == /*"top"*/ STR(191))
			draw_label(self, { string_limit(text_get({ name }), sVar(dw)), xx, yy - IntType(3), fa_left, fa_top, labelcolor, labelalpha });
		else
			if (labelpos != /*"none"*/ STR(899))
				draw_label(self, { text_get({ name }), xx, yy + h / 2.0, fa_left, fa_middle, labelcolor, labelalpha });
		
		return update;
	}
	
	VarType draw_textfield_group(ScopeAny self, StringType name, VarType xx, VarType yy, VarType wid, VarType mul, VarType minval, VarType maxval, RealType snapval, RealType showcaption, RealType stack, RealType colortype, BoolType drag, BoolType textfield_update)
	{
		RealType vertical, hei;
		VarType fieldx, fieldy, fieldwid, fieldupdate;
		vertical = (global::_app->panel_compact > 0) && stack > 0;
		fieldx = xx;
		fieldy = yy;
		fieldwid = (vertical > 0) ? wid : VarType(((RealType)wid / sReal(textfield_amount)));
		fieldupdate = VarType();
		hei = ((vertical > 0) ? (sReal(ui_small_height) * sReal(textfield_amount)) : sReal(ui_small_height)) + ((label_height + IntType(8)) * showcaption);
		if (xx + wid < sVar(content_x) || xx > sVar(content_x) + sVar(content_width) || yy + hei < sVar(content_y) || yy > sVar(content_y) + sVar(content_height))
		{
			textfield_group_reset(self);
			return IntType(0);
		}
		IntType dragw;
		BoolType mouseon;
		mouseon = app_mouse_box(self, xx, yy, wid, hei) && sBool(content_mouseon);
		microani_set(string(sVar(textfield_textbox).Value(sReal(textfield_amount) - IntType(1))) + sVar(textfield_name).Value(sReal(textfield_amount) - IntType(1)), sVar(textfield_script).Value(sReal(textfield_amount) - IntType(1)), false, false, false, false, IntType(1), false);
		VarType active = ObjType(micro_animation, global::current_microani)->custom;
		microani_set(name, null_, mouseon || active > 0, false, false);
		microani_update({ mouseon || active > 0, false, false });
		if (showcaption > 0)
		{
			draw_set_font(sInt(font_label));
			draw_label(self, { string_limit(text_get({ name }), sVar(dw)), xx, yy, fa_left, fa_top, global::c_text_secondary, global::a_text_secondary });
			yy += (label_height + IntType(8));
		}
		hei = sReal(ui_small_height);
		fieldx = xx;
		fieldy = yy;
		dragw = IntType(16);
		draw_box(xx, yy, wid, ((vertical > 0) ? sReal(textfield_amount) * hei : hei), false, global::c_level_top, draw_get_alpha());
		if (vertical > 0)
			draw_outline(fieldx, fieldy, wid, sReal(textfield_amount) * hei, IntType(1), global::c_border, global::a_border, true);
		else
			draw_outline(fieldx, fieldy, wid, hei, IntType(1), global::c_border, global::a_border, true);
		
		draw_set_font(sInt(font_label));
		for (IntType i = IntType(0); i < sReal(textfield_amount); i++)
		{
			if (i > IntType(0))
			{
				if (vertical > 0)
					draw_box(fieldx + IntType(1), fieldy - IntType(1), fieldwid - IntType(2), IntType(1), false, global::c_border, global::a_border);
				else
					draw_box(fieldx, fieldy + IntType(1), IntType(1), hei - IntType(2), false, global::c_border, global::a_border);
				
			}
			if (vertical > 0)
				fieldy += hei;
			else
				fieldx += fieldwid;
			
			dragw = max({ dragw, string_width(text_get({ sVar(textfield_caption).Value(i) != null_ ? sVar(textfield_caption).Value(i) : sVar(textfield_name).Value(i) })) + IntType(16) });
		}
		fieldx = xx;
		fieldy = yy;
		VarType boxwid, boxy, update;
		RealType boxhei;
		active = false;
		for (IntType i = IntType(0); i < sReal(textfield_amount); i++)
		{
			global::axis_edit = sVar(textfield_axis).Value(i);
			boxhei = hei;
			boxwid = fieldwid;
			boxy = fieldy;
			if (i < (sReal(textfield_amount) - IntType(1)) && !(vertical > 0))
				boxwid += IntType(1);
			if (i != IntType(0) && vertical > 0)
			{
				boxhei += IntType(1);
				boxy -= 1.0;
			}
			mouseon = app_mouse_box(self, fieldx, boxy, boxwid, boxhei) && sBool(content_mouseon);
			if (sVar(textfield_min) != null_)
			{
				minval = sVar(textfield_min).Value(i);
				maxval = sVar(textfield_max).Value(i);
			}
			context_menu_area(self, { fieldx, boxy, boxwid, boxhei, /*"contextmenuvalue"*/ STR(1066), sVar(textfield_value).Value(i), e_context_type_NUMBER, sVar(textfield_script).Value(i), sVar(textfield_default).Value(i) });
			microani_set(string(sVar(textfield_textbox).Value(i)) + sVar(textfield_name).Value(i), sVar(textfield_script).Value(i), mouseon || sVar(window_focus) == string(sVar(textfield_textbox).Value(i)), false, (mouseon && sBool(mouse_left)) || (sVar(window_focus) == string(sVar(textfield_textbox).Value(i))));
			VarType focus;
			IntType linecolor;
			RealType linealpha;
			focus = max({ global::microani_arr.Value(e_microani_PRESS), global::microani_arr.Value(e_microani_ACTIVE) });
			linecolor = merge_color((IntType)(global::c_border), (IntType)(global::c_text_tertiary), global::microani_arr.Value(e_microani_HOVER));
			linecolor = merge_color(linecolor, (IntType)(global::c_accent), focus);
			linealpha = lerp(0.0, global::a_text_tertiary, global::microani_arr.Value(e_microani_HOVER));
			linealpha = lerp(linealpha, global::a_accent, focus);
			VarType labelcolor;
			RealType labelalpha;
			if (colortype > IntType(0))
			{
				if (colortype == IntType(1))
				{
					if (global::axis_edit == X_)
						labelcolor = global::c_axisred;
					else
						if (global::axis_edit == Y_)
							labelcolor = ((sReal(setting_z_is_up) > 0) ? global::c_axisgreen : global::c_axisblue);
						else
							labelcolor = ((sReal(setting_z_is_up) > 0) ? global::c_axisblue : global::c_axisgreen);
					
					
				}
				else
					if (colortype == IntType(2))
					{
						if (global::axis_edit == X_)
							labelcolor = global::c_axiscyan;
						else
							if (global::axis_edit == Y_)
								labelcolor = ((sReal(setting_z_is_up) > 0) ? global::c_axisyellow : global::c_axismagenta);
							else
								labelcolor = ((sReal(setting_z_is_up) > 0) ? global::c_axismagenta : global::c_axisyellow);
						
						
					}
					else
						if (colortype == IntType(3))
						{
							if (i == IntType(0))
								labelcolor = global::c_axisred;
							else
								if (i == IntType(1))
									labelcolor = global::c_axisgreen;
								else
									labelcolor = global::c_axisblue;
							
							
						}
				
				
				labelalpha = IntType(1);
			}
			else
			{
				labelcolor = merge_color((IntType)(global::c_text_secondary), (IntType)(global::c_text_main), global::microani_arr.Value(e_microani_HOVER));
				labelcolor = merge_color((IntType)(labelcolor), (IntType)(global::c_accent), focus);
				labelalpha = lerp(global::a_text_secondary, global::a_text_main, global::microani_arr.Value(e_microani_HOVER));
				labelalpha = lerp(labelalpha, global::a_accent, focus);
			}
			
			if (sVar(textfield_icon).Value(i) == null_)
				draw_label(self, { text_get({ sVar(textfield_caption).Value(i) != null_ ? sVar(textfield_caption).Value(i) : sVar(textfield_name).Value(i) }), fieldx + IntType(8), boxy + ceil(boxhei / 2.0), fa_left, fa_middle, labelcolor, labelalpha, sInt(font_label) });
			else
				draw_image({ ID_spr_icons, sVar(textfield_icon).Value(i), floor(fieldx + 14.0), boxy + ceil(boxhei / 2.0), IntType(1), IntType(1), global::c_text_secondary, global::a_text_secondary });
			
			draw_outline(fieldx, boxy, boxwid, boxhei, IntType(1), global::c_level_middle, max({ focus, global::microani_arr.Value(e_microani_HOVER) }), true);
			draw_outline(fieldx, boxy, boxwid, boxhei, IntType(1), linecolor, linealpha, true);
			draw_box_hover({ fieldx, boxy, boxwid, boxhei, global::microani_arr.Value(e_microani_PRESS) });
			if (sVar(textfield_value).Value(i) < minval || sVar(textfield_value).Value(i) > maxval)
				draw_box(fieldx, boxy, boxwid, boxhei, false, global::c_error, global::a_accent_overlay);
			else
				if ((abs(maxval) + abs(minval)) < IntType(100000))
				{
					RealType perc = percent(sVar(textfield_value).Value(i), minval, maxval);
					draw_box(fieldx, boxy, boxwid * perc, boxhei, false, global::c_accent_hover, global::a_accent_overlay);
				}
			
			active = (active > 0 || sVar(window_focus) == string(sVar(textfield_textbox).Value(i)));
			microani_update({ mouseon, mouseon && sBool(mouse_left), sVar(window_focus) == string(sVar(textfield_textbox).Value(i)) || (sVar(window_busy) == sVar(textfield_name).Value(i) + /*"drag"*/ STR(30)) || (sVar(window_busy) == sVar(textfield_name).Value(i) + /*"press"*/ STR(1074)), false, active });
			draw_set_font(sInt(font_digits));
			BoolType update = textbox_draw(self, sVar(textfield_textbox).Value(i), fieldx + dragw, boxy + ceil(boxhei / 2.0) - IntType(7), boxwid - (IntType(8) + dragw), IntType(18), true, true);
			if (app_mouse_box(self, fieldx + dragw, boxy, boxwid - (IntType(8) + dragw), boxhei) && sBool(content_mouseon) && sVar(window_focus) != string(sVar(textfield_textbox).Value(i)))
			{
				if (sBool(mouse_left_released))
				{
					sVar(window_focus) = string(sVar(textfield_textbox).Value(i));
					sVar(window_busy) = /*""*/ STR(0);
				}
			}
			if (app_mouse_box(self, fieldx, boxy, boxwid, boxhei) && sBool(content_mouseon) && sVar(window_focus) != string(sVar(textfield_textbox).Value(i)) && drag)
			{
				sInt(mouse_cursor) = cr_size_we;
				if (sBool(mouse_left_pressed))
					sVar(window_busy) = sVar(textfield_name).Value(i) + /*"press"*/ STR(1074);
			}
			if (sVar(window_busy) == sVar(textfield_name).Value(i) + /*"press"*/ STR(1074))
			{
				sInt(mouse_cursor) = cr_size_we;
				if (!sBool(mouse_left))
				{
					sVar(window_focus) = string(sVar(textfield_textbox).Value(i));
					sVar(window_busy) = /*""*/ STR(0);
					app_mouse_clear(self);
				}
				else
					if (sReal(mouse_dx) != IntType(0))
					{
						sVar(dragger_drag_value) = sVar(textfield_value).Value(i);
						sVar(window_busy) = sVar(textfield_name).Value(i) + /*"drag"*/ STR(30);
					}
				
			}
			if (sVar(window_busy) == sVar(textfield_name).Value(i) + /*"drag"*/ STR(30))
			{
				sInt(mouse_cursor) = cr_none;
				sVar(dragger_drag_value) += (gmlGlobal::mouse_x - sInt(mouse_click_x)) * (sVar(textfield_mul).Value(i) == null_ ? mul : sVar(textfield_mul).Value(i)) * sReal(dragger_multiplier);
				window_mouse_set(sInt(mouse_click_x), sInt(mouse_click_y));
				RealType d;
				if (global::_app->setting_unlimited_values > 0)
					d = snap(sVar(dragger_drag_value), snapval) - sVar(textfield_value).Value(i);
				else
					d = clamp(snap(sVar(dragger_drag_value), snapval), minval, maxval) - sVar(textfield_value).Value(i);
				
				if (d != IntType(0) && sVar(textfield_script).Value(i) != null_ && textfield_update)
					script_execute(self, { sVar(textfield_script).Value(i), d, true });
				else
				{
					idVar(sVar(textfield_textbox)[i], text) = string_decimals(sVar(textfield_value).Value(i) + d);
					fieldupdate = sVar(textfield_textbox).Value(i);
				}
				
				if (!sBool(mouse_left))
				{
					sVar(window_busy) = /*""*/ STR(0);
					app_mouse_clear(self);
					script_execute(self, { sVar(textfield_script).Value(i), d, true });
				}
			}
			if (update)
			{
				VarType val = eval(idVar(sVar(textfield_textbox).Value(i), text), sVar(textfield_default).Value(i));
				if (sVar(textfield_script).Value(i) != null_)
					script_execute(self, { sVar(textfield_script).Value(i), (global::_app->setting_unlimited_values > 0) ? snap(val, snapval) : VarType(clamp(snap(val, snapval), minval, maxval)), false });
				else
					fieldupdate = val;
				
			}
			if (sVar(window_busy) != sVar(textfield_name).Value(i) + /*"press"*/ STR(1074) && sVar(window_focus) != string(sVar(textfield_textbox).Value(i)) && fieldupdate == VarType())
				idVar(sVar(textfield_textbox)[i], text) = string_decimals(sVar(textfield_value).Value(i));
			if (vertical > 0)
				fieldy += hei;
			else
				fieldx += fieldwid;
			
		}
		textfield_group_reset(self);
		return fieldupdate;
	}
	
}
